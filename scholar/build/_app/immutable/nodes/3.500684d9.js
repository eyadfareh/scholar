import{p as z}from"../chunks/db.47a53725.js";import{s as U,n as D,f as M,a as ee,b as te}from"../chunks/scheduler.7ca2eff6.js";import{S as B,i as F,g as b,m as O,s as q,h as $,j as y,n as S,f as m,c as H,k,a as w,y as v,o as L,z as K,A as Q,B as se,r as W,x as le,u as X,v as Y,d as V,b as ne,t as j,w as Z,p as ae}from"../chunks/index.a1532baf.js";import{e as P}from"../chunks/each.e59479a4.js";import{i as re}from"../chunks/navigation.be8bdadf.js";async function ce({params:c}){const e=await z.collection("courses").getOne(c.id),s=(await z.collection("chapters").getList(1,50,{filter:`course.id = "${c.id}"`,sort:"+number"})).items;let t=[];for(let a=0;a<s.length;a++){t.push(s[a]);const o=await z.collection("sections").getFullList({filter:`chapter.id = "${t[a].id}"`,sort:"+number"});t[a].sections=o}return{id:c.id,course:e,chapters:t}}const Ce=Object.freeze(Object.defineProperty({__proto__:null,load:ce},Symbol.toStringTag,{value:"Module"}));function N(c,e,s){const t=c.slice();return t[1]=e[s],t}function R(c){let e,s,t=c[1].title+"",a,o,i;return{c(){e=b("a"),s=b("div"),a=O(t),o=q(),this.h()},l(r){e=$(r,"A",{href:!0});var n=y(e);s=$(n,"DIV",{class:!0});var l=y(s);a=S(l,t),l.forEach(m),o=H(n),n.forEach(m),this.h()},h(){k(s,"class","section svelte-1fq2rre"),k(e,"href",i=`/section/${c[1].id}`)},m(r,n){w(r,e,n),v(e,s),v(s,a),v(e,o)},p(r,n){n&1&&t!==(t=r[1].title+"")&&L(a,t),n&1&&i!==(i=`/section/${r[1].id}`)&&k(e,"href",i)},d(r){r&&m(e)}}}function ie(c){let e,s,t=c[0].title+"",a,o,i,r=P(c[0].sections),n=[];for(let l=0;l<r.length;l+=1)n[l]=R(N(c,r,l));return{c(){e=b("div"),s=b("h4"),a=O(t),o=q(),i=b("div");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=$(l,"DIV",{class:!0});var d=y(e);s=$(d,"H4",{class:!0});var u=y(s);a=S(u,t),u.forEach(m),o=H(d),i=$(d,"DIV",{class:!0});var g=y(i);for(let I=0;I<n.length;I+=1)n[I].l(g);g.forEach(m),d.forEach(m),this.h()},h(){k(s,"class","svelte-1fq2rre"),k(i,"class","sections svelte-1fq2rre"),k(e,"class","chapter svelte-1fq2rre")},m(l,d){w(l,e,d),v(e,s),v(s,a),v(e,o),v(e,i);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(i,null)},p(l,[d]){if(d&1&&t!==(t=l[0].title+"")&&L(a,t),d&1){r=P(l[0].sections);let u;for(u=0;u<r.length;u+=1){const g=N(l,r,u);n[u]?n[u].p(g,d):(n[u]=R(g),n[u].c(),n[u].m(i,null))}for(;u<n.length;u+=1)n[u].d(1);n.length=r.length}},i:D,o:D,d(l){l&&m(e),K(n,l)}}}function oe(c,e,s){let{chapter:t}=e;return c.$$set=a=>{"chapter"in a&&s(0,t=a.chapter)},[t]}class he extends B{constructor(e){super(),F(this,e,oe,ie,U,{chapter:0})}}function ue(c){let e;return{c(){e=O("Add Chapter")},l(s){e=S(s,"Add Chapter")},m(s,t){w(s,e,t)},p:D,d(s){s&&m(e)}}}function fe(c){let e,s,t,a,o;return{c(){e=O(`Add Chapter
		`),s=b("form"),t=b("input"),this.h()},l(i){e=S(i,`Add Chapter
		`),s=$(i,"FORM",{});var r=y(s);t=$(r,"INPUT",{name:!0,class:!0}),r.forEach(m),this.h()},h(){k(t,"name","title"),k(t,"class","svelte-hm1krg")},m(i,r){w(i,e,r),w(i,s,r),v(s,t),c[5](t),a||(o=Q(s,"submit",se(c[3])),a=!0)},p:D,d(i){i&&(m(e),m(s)),c[5](null),a=!1,o()}}}function de(c){let e,s,t,a;function o(n,l){return n[0]?fe:ue}let i=o(c),r=i(c);return{c(){e=b("div"),r.c(),this.h()},l(n){e=$(n,"DIV",{class:!0});var l=y(e);r.l(l),l.forEach(m),this.h()},h(){k(e,"class",s=M("add-chapter "+(c[0]?"adding":""))+" svelte-hm1krg")},m(n,l){w(n,e,l),r.m(e,null),t||(a=Q(e,"click",c[2]),t=!0)},p(n,[l]){i===(i=o(n))&&r?r.p(n,l):(r.d(1),r=i(n),r&&(r.c(),r.m(e,null))),l&1&&s!==(s=M("add-chapter "+(n[0]?"adding":""))+" svelte-hm1krg")&&k(e,"class",s)},i:D,o:D,d(n){n&&m(e),r.d(),t=!1,a()}}}function _e(c,e,s){let{courseId:t}=e,a=!1,o;function i(l){console.log("Editing"),s(0,a=!0)}ee(()=>{console.log("Updating"),a&&o.focus()});async function r(l){console.log(l.target.title.value);const d={number:123,title:l.target.title.value,course:t};await z.collection("chapters").create(d),s(0,a=!1),re()}function n(l){te[l?"unshift":"push"](()=>{o=l,s(1,o)})}return c.$$set=l=>{"courseId"in l&&s(4,t=l.courseId)},[a,o,i,r,t,n]}class pe extends B{constructor(e){super(),F(this,e,_e,de,U,{courseId:4})}}function G(c,e,s){const t=c.slice();return t[1]=e[s],t}function J(c){let e,s;return e=new he({props:{chapter:c[1]}}),{c(){W(e.$$.fragment)},l(t){X(e.$$.fragment,t)},m(t,a){Y(e,t,a),s=!0},p(t,a){const o={};a&1&&(o.chapter=t[1]),e.$set(o)},i(t){s||(V(e.$$.fragment,t),s=!0)},o(t){j(e.$$.fragment,t),s=!1},d(t){Z(e,t)}}}function me(c){let e,s,t=c[0].course.title+"",a,o,i,r,n="Chapters",l,d,u,g,I,E=P(c[0].chapters),f=[];for(let h=0;h<E.length;h+=1)f[h]=J(G(c,E,h));const x=h=>j(f[h],1,1,()=>{f[h]=null});return g=new pe({props:{courseId:c[0].id}}),{c(){e=b("section"),s=b("h1"),a=O(t),o=q(),i=b("div"),r=b("h2"),r.textContent=n,l=q(),d=b("div");for(let h=0;h<f.length;h+=1)f[h].c();u=q(),W(g.$$.fragment),this.h()},l(h){e=$(h,"SECTION",{});var p=y(e);s=$(p,"H1",{class:!0});var C=y(s);a=S(C,t),C.forEach(m),o=H(p),i=$(p,"DIV",{class:!0});var _=y(i);r=$(_,"H2",{"data-svelte-h":!0}),le(r)!=="svelte-1xf5vy0"&&(r.textContent=n),l=H(_),d=$(_,"DIV",{class:!0});var A=y(d);for(let T=0;T<f.length;T+=1)f[T].l(A);u=H(A),X(g.$$.fragment,A),A.forEach(m),_.forEach(m),p.forEach(m),this.h()},h(){k(s,"class","svelte-zpu2dd"),k(d,"class","chapters svelte-zpu2dd"),k(i,"class","container")},m(h,p){w(h,e,p),v(e,s),v(s,a),v(e,o),v(e,i),v(i,r),v(i,l),v(i,d);for(let C=0;C<f.length;C+=1)f[C]&&f[C].m(d,null);v(d,u),Y(g,d,null),I=!0},p(h,[p]){if((!I||p&1)&&t!==(t=h[0].course.title+"")&&L(a,t),p&1){E=P(h[0].chapters);let _;for(_=0;_<E.length;_+=1){const A=G(h,E,_);f[_]?(f[_].p(A,p),V(f[_],1)):(f[_]=J(A),f[_].c(),V(f[_],1),f[_].m(d,u))}for(ae(),_=E.length;_<f.length;_+=1)x(_);ne()}const C={};p&1&&(C.courseId=h[0].id),g.$set(C)},i(h){if(!I){for(let p=0;p<E.length;p+=1)V(f[p]);V(g.$$.fragment,h),I=!0}},o(h){f=f.filter(Boolean);for(let p=0;p<f.length;p+=1)j(f[p]);j(g.$$.fragment,h),I=!1},d(h){h&&m(e),K(f,h),Z(g)}}}function ve(c,e,s){let{data:t}=e;return c.$$set=a=>{"data"in a&&s(0,t=a.data)},[t]}class Ie extends B{constructor(e){super(),F(this,e,ve,me,U,{data:0})}}export{Ie as component,Ce as universal};
